<%- include("partials/navbar") %>

<style>
    body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background: #f5f5f5;
    }

    .quiz-container {
        max-width: 700px;
        background: white;
        margin: auto;
        padding: 25px;
        margin-top: 150px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    input, button {
        width: 100%;
        padding: 12px;
        margin: 10px 0;
        font-size: 16px;
        border-radius: 8px;
        border: 1px solid #ccc;
    }

    button {
        background: #4CAF50;
        color: white;
        font-weight: bold;
        cursor: pointer;
        border: none;
    }

    button:hover {
        background: #45a049;
    }

    #loader {
        display: none;
        font-size: 18px;
        text-align: center;
        color: #555;
        font-weight: bold;
        margin: 15px 0;
    }

    .mcq {
        background: #eee;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 15px;
    }

    .option {
        margin-left: 20px;
        margin-top: 5px;
    }
</style>

<div class="quiz-container">
    <h2>AI MCQ Quiz Generator</h2>

    <label>Enter Topic:</label>
    <input type="text" id="topic" placeholder="e.g., Data Structures, OOPs, HTML">

    <label>Number of Questions:</label>
    <input type="number" id="count" placeholder="e.g., 5">

    <button onclick="generateQuiz()">Generate Quiz</button>

    <p id="loader">Generating Quiz… Please wait ⏳</p>

    <div id="quiz-output"></div>
</div>

<script>
async function generateQuiz() {
    const topic = document.getElementById("topic").value.trim();
    const count = document.getElementById("count").value.trim();
    const output = document.getElementById("quiz-output");
    const loader = document.getElementById("loader");

    if (!topic || !count) {
        alert("Please enter topic and number of questions!");
        return;
    }

    loader.style.display = "block";
    output.innerHTML = "";

    try {
        const res = await fetch("/api/generate-quiz", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ topic, count })
        });

        const data = await res.json();
        loader.style.display = "none";

        if (data.error) {
            output.innerHTML = "<p style='color:red;'>Error generating quiz.</p>";
            return;
        }

        // Display MCQs
        data.quiz.forEach((q, idx) => {
            const block = document.createElement("div");
            block.classList.add("mcq");
            block.innerHTML = `
                <b>Q${idx + 1}: ${q.question}</b>
                <div class="option">A. ${q.options[0]}</div>
                <div class="option">B. ${q.options[1]}</div>
                <div class="option">C. ${q.options[2]}</div>
                <div class="option">D. ${q.options[3]}</div>
                <br><b>Correct Answer:</b> ${q.answer}
            `;
            output.appendChild(block);
        });

    } catch (err) {
        loader.style.display = "none";
        output.innerHTML = "<p style='color:red;'>Server error.</p>";
    }
}
</script>

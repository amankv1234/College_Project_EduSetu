<%- include("partials/navbar") %>

<style>
    body {
        font-family: Arial, sans-serif;
        background: #f4f4f4;
        padding: 20px;
    }
    .box {
        background: white;
        padding: 20px;
        border-radius: 12px;
        max-width: 700px;
        margin: auto;
        margin-top: 50px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .progress-bar {
        width: 100%;
        height: 25px;
        background: #ddd;
        border-radius: 10px;
        overflow: hidden;
        margin-top: 5px;
    }
    .progress-fill {
        height: 100%;
        background: #4CAF50;
        width: 0%;
        text-align: center;
        color: #fff;
        font-size: 14px;
        line-height: 25px;
    }
    button {
        padding: 10px 20px;
        margin-top: 20px;
        font-size: 16px;
        border: none;
        background: #007bff;
        color: white;
        border-radius: 8px;
        cursor: pointer;
    }
    #resultBox {
        margin-top: 25px;
        display: none;
        background: #222;
        color: #0f0;
        padding: 15px;
        border-radius: 10px;
        font-family: monospace;
        white-space: pre-line;
    }
    #loader {
        display: none;
        margin-top: 10px;
    }
</style>

<div class="box">
    <h2>Success Prediction AI</h2>
    <p>AI predicts your placement readiness based on your learning progress.</p>

    <label>Data Structures Progress</label>
    <div class="progress-bar"><div class="progress-fill" id="dsaFill">0%</div></div>
    <input type="range" id="dsa" min="0" max="100" value="40" oninput="updateFill('dsa')">

    <label>Web Development Progress</label>
    <div class="progress-bar"><div class="progress-fill" id="webFill">0%</div></div>
    <input type="range" id="web" min="0" max="100" value="30" oninput="updateFill('web')">

    <label>Communication Skills Progress</label>
    <div class="progress-bar"><div class="progress-fill" id="engFill">0%</div></div>
    <input type="range" id="eng" min="0" max="100" value="50" oninput="updateFill('eng')">

    <button onclick="predictSuccess()">Predict Success</button>

    <div id="loader">‚è≥ AI analyzing your progress...</div>

    <div id="resultBox"></div>
</div>

<script>
function updateFill(id) {
    const slider = document.getElementById(id);
    const fill = document.getElementById(id + "Fill");
    fill.style.width = slider.value + "%";
    fill.innerText = slider.value + "%";
}

// SET DEFAULT FILLS
updateFill("dsa");
updateFill("web");
updateFill("eng");

async function predictSuccess() {
    const dsa = document.getElementById("dsa").value;
    const web = document.getElementById("web").value;
    const eng = document.getElementById("eng").value;

    document.getElementById("loader").style.display = "block";

    const res = await fetch("/api/predict-success", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ dsa, web, eng })
    });

    const data = await res.json();
    document.getElementById("loader").style.display = "none";

    document.getElementById("resultBox").style.display = "block";
    document.getElementById("resultBox").innerText = data.prediction;
}
</script>
